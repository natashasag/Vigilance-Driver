<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vigilance Driver - Dashboard</title>

  <link rel="stylesheet" href="./styles.css">

  <script src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.min.js"></script>
  <script src="app.js" defer></script>
</head>

<body>

  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-brand">
      <h1>üëÅ Driver Drowsiness Detection</h1>
      <p>Real-time EAR & Facial Landmark Monitoring</p>
    </div>

    <div class="header-actions">
      <span class="status-online">üü¢ Online</span>
      <button class="btn-privacy" onclick="togglePrivacy()">üõ° Privacy Mode</button>
      <button class="btn-signout" onclick="signOut()">üö™ Sign Out</button>
    </div>
  </header>

  <!-- Main Grid -->
  <div class="dashboard-grid">

    <!-- LEFT SIDE -->
    <div>

      <!-- Video Card -->
      <div class="card">
        <div class="video-container">
          <video id="video" muted playsinline></video>
          <canvas id="overlayCanvas"></canvas>

          <div class="video-placeholder" id="placeholder">
            <p id="placeholderText">Loading face detection models...</p>
          </div>
        </div>
      </div>

      <!-- Start Button -->
      <button id="toggleBtn" class="btn-start" onclick="toggleDetection()">
        üì∑ Start Detection
      </button>

      <!-- Session Log -->
      <div class="card session-log">
        <div class="session-log-header">
          <h3>üïê Session Log</h3>
          <span id="logCount">0 events</span>
        </div>

        <div class="log-entries" id="logList">
          <p class="log-empty">Start detection to see logs</p>
        </div>
      </div>

    </div>

    <!-- RIGHT SIDE -->
    <div>

      <!-- Status -->
      <div class="card">
        <div class="card-header">Current Status</div>
        <div class="status-badge alert" id="statusBanner">
          Driver Alert
        </div>
      </div>

      <!-- EAR -->
      <div class="card">
        <div class="card-header">Eye Aspect Ratio (EAR)</div>
        <div class="ear-value" id="earValue">0.000</div>
        <div class="ear-info" id="earStatus">
          Threshold: 0.25 | Eyes Open
        </div>

        <div class="progress-bar">
          <div class="progress-fill green" id="earBar" style="width:0%"></div>
        </div>
      </div>

      <!-- Drowsiness -->
      <div class="card">
        <div class="card-header">‚ö° Multi-Factor Drowsiness Score</div>

        <div class="drowsiness-score" id="drowsinessValue">0</div>
        <div class="fatigue-label" id="fatigueLabel">
          Low Fatigue Level
        </div>

        <div class="progress-bar">
          <div class="progress-fill green" id="drowsinessBar" style="width:0%"></div>
        </div>

        <div class="why-section">
          <h4>‚ö† Why this score?</h4>
          <p id="explainText">‚Ä¢ Alertness levels are normal</p>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="microSleeps">0</div>
          <div class="stat-label">Micro-sleeps</div>
        </div>

        <div class="stat-card">
          <div class="stat-value" id="blinkRate">0/min</div>
          <div class="stat-label">Blink Rate</div>
        </div>

        <div class="stat-card">
          <div class="stat-value" id="blinks">0</div>
          <div class="stat-label">Blinks</div>
        </div>

        <div class="stat-card">
          <div class="stat-value" id="yawns">0</div>
          <div class="stat-label">Yawns</div>
        </div>
      </div>

      <!-- Head Pose -->
      <div class="card">
        <div class="card-header">Head Pose Score</div>
        <div class="head-pose-row">
          <div class="progress-bar head-pose-bar">
            <div class="progress-fill green" id="headPoseBar" style="width:0%"></div>
          </div>
          <span class="head-pose-val" id="headPoseValue">0%</span>
        </div>
      </div>

    </div>
  </div>

  <!-- Bottom Section -->
  <div class="bottom-grid">

    <!-- Driving Modes -->
    <div class="card">
      <div class="card-header">‚öô Driving Modes</div>

      <div class="mode-item active">
        <div class="mode-icon green">üõ°</div>
        <div class="mode-info">
          <h4>Safety Mode</h4>
          <p>Maximum sensitivity & alerts</p>
        </div>
      </div>

      <div class="mode-item">
        <div class="mode-icon gray">‚ö°</div>
        <div class="mode-info">
          <h4>Eco Mode</h4>
          <p>Reduced processing, saves battery</p>
        </div>
      </div>

      <div class="mode-status">
        ‚ö° Maximum protection active
      </div>
    </div>

    <!-- Wellness -->
    <div class="card wellness-card">
      <h3>‚ù§ Wellness Insights</h3>
      <div class="wellness-msg">
        <h4 id="wellnessTitle">‚ú® Great Alertness!</h4>
        <p id="wellnessText">
          Your eye openness is excellent. Keep maintaining good sleep habits.
        </p>
      </div>

      <div class="wellness-stats">
        <div>
          <div class="wellness-stat-value" id="sessionTime">0m 0s</div>
          <div class="wellness-stat-label">Session Time</div>
        </div>

        <div>
          <div class="wellness-stat-value" id="avgAlertness">100%</div>
          <div class="wellness-stat-label">Avg Alertness</div>
        </div>
      </div>
    </div>

  </div>

  <!-- How It Works -->
  <div class="how-section">
    <div class="how-card">
      <h3>How It Works</h3>
      <div class="how-grid">
        <div>
          <h4>EAR FORMULA:</h4>
          <code>
            EAR = (|p2-p6| + |p3-p5|) / (2 √ó |p1-p4|)
          </code>
        </div>
        <div>
          <h4>DETECTION FEATURES:</h4>
          <ul>
           <li>68-point facial landmark detection</li>
           <li>Real-time EAR & MAR calculation</li>
           <li>Micro-sleep detection</li>
           <li>Head pose monitoring</li> 
           <li>Multi-factor drowsiness scoring</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-grid">
      <div class="footer-brand">
        <h3>üëÅ Vigilance Driver</h3>
        <p>Driver Drowsiness Detection System Using advanced facial landmark analysis and Eye Aspect Ratio (EAR) technology to keep drivers safe on the road.</p>
      </div>
        <div class="footer-tags"><span>üõ°Privacy First</span><span>‚ö° Real-time</span></div>
      <div class="footer-col">
        <h4>FEATURES</h4>
        <ul>
          <li>EAR Detection</li>
          <li>Micro-sleep Alerts</li>
          <li>Head Pose Tracking</li>
          <li>Yawn Detection</li>
          <li>Session Analytics</li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>TECHNOLOGY</h4>
        <ul>
          <li>face-api.js</li>
          <li>68-Point Landmarks</li>
          <li>Web Audio API</li>
          <li>Flask + Python</li>
          <li>Real-time Processing</li>

        </ul>
      </div>
    </div>

    <div class="footer-copy">
      ¬© 2026 VIGILANCE DRIVER-Driver Drowsiness Detection System. All rights reserved.
    </div>
  </footer>

</body>
</html>