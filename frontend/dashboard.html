<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vigilance Driver - Dashboard</title>

  <link rel="stylesheet" href="styles.css?v=2026">
  <script src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.min.js"></script>
</head>

<body>

  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-brand">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:#22c55e">
        <circle cx="12" cy="12" r="3"/>
        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
      </svg>
      <div>
        <h1>Driver Drowsiness Detection</h1>
        <p>Real-time EAR & Facial Landmark Monitoring</p>
      </div>
    </div>
    <div class="header-actions">
      <span class="status-online">ğŸ“¶ Online</span>
      <button class="btn-privacy">ğŸ›¡ Privacy Mode ğŸ‘</button>
      <button class="btn-signout" onclick="logout()">â†ª Sign Out</button>
    </div>
  </header>

  <!-- MAIN GRID -->
  <div class="dashboard-grid">

    <!-- LEFT COLUMN -->
    <div>

      <!-- VIDEO CARD -->
      <div class="card">
        <div class="video-container" style="position:relative">

          <video id="webcam"
            autoplay
            muted
            playsinline
            style="width:100%;height:100%;object-fit:cover">
          </video>

          <canvas id="overlayCanvas"
            style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none">
          </canvas>

          <div class="video-placeholder" id="videoPlaceholder">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="12" cy="12" r="3"/>
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
            </svg>
            <p id="modelStatus">Loading face detection models...</p>
            <p>Click Start to begin detection</p>
          </div>

        </div>
      </div>

      <!-- START BUTTON BELOW VIDEO -->
      <button class="btn-start"
              id="btnStart"
              onclick="toggleDetection()"
              style="margin-top:16px">
        ğŸ“· Start Detection
      </button>

      <!-- SESSION LOG -->
      <div class="card" style="margin-top:24px">
        <div class="session-log">
          <div class="session-log-header">
            <h3>ğŸ• Session Log</h3>
            <span id="logCount" style="color:#6b7a8d;font-size:13px">0 events</span>
          </div>
          <div class="log-entries" id="logEntries">
            <p class="log-empty">Start detection to see logs</p>
          </div>
        </div>
      </div>

    </div>

    <!-- RIGHT COLUMN -->
    <div>

      <!-- STATUS -->
      <div class="card">
        <div class="card-header">Current Status</div>
        <div class="status-badge alert" id="statusBadge">Driver Alert</div>
      </div>

      <!-- EAR -->
      <div class="card" style="margin-top:16px">
        <div class="card-header">Eye Aspect Ratio (EAR)</div>
        <div class="ear-value" id="earValue">0.300</div>
        <div class="ear-info" id="earInfo">Threshold: 0.25 | Eyes Open</div>
        <div class="progress-bar">
          <div class="progress-fill green" id="earFill" style="width:75%"></div>
        </div>
      </div>

      <!-- DROWSINESS SCORE -->
      <div class="card" style="margin-top:16px">
        <div class="card-header">âš™ Multi-Factor Drowsiness Score</div>
        <div class="drowsiness-score" id="drowsinessScore">15</div>
        <div class="fatigue-label" id="fatigueLabel" style="color:#22c55e">
          Low Fatigue Level
        </div>
        <div class="progress-bar">
          <div class="progress-fill green" id="drowsinessFill" style="width:15%"></div>
        </div>
        <div class="why-section">
          <h4>âš  Why this score?</h4>
          <p id="whyText">â€¢ Alertness levels are normal</p>
        </div>
      </div>

      <!-- QUICK STATS -->
      <div class="stats-grid" style="margin-top:16px">
        <div class="stat-card"><div class="stat-value" id="statMicrosleeps">0</div><div class="stat-label">Micro-sleeps</div></div>
        <div class="stat-card"><div class="stat-value" id="statBlinkRate">0/min</div><div class="stat-label">Blink Rate</div></div>
        <div class="stat-card"><div class="stat-value" id="statBlinks">0</div><div class="stat-label">Blinks</div></div>
        <div class="stat-card"><div class="stat-value" id="statYawns">0</div><div class="stat-label">Yawns</div></div>
        <div class="stat-card"><div class="stat-value" id="statAlerts">0</div><div class="stat-label">Alerts</div></div>
        <div class="stat-card"><div class="stat-value" id="statMicrosleeps2">0</div><div class="stat-label">Micro-sleeps</div></div>
      </div>

      <!-- HEAD POSE -->
      <div class="card" style="margin-top:16px">
        <div class="card-header">Head Pose Score</div>
        <div class="head-pose-row">
          <div class="progress-bar head-pose-bar">
            <div class="progress-fill green" id="headPoseFill" style="width:100%"></div>
          </div>
          <span class="head-pose-val" id="headPoseVal">100%</span>
        </div>
      </div>

    </div>

  </div>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="footer-grid">
      <div class="footer-brand">
        <h3>ğŸ‘ Vigilance Driver</h3>
        <p>
          Driver drowsiness detection system using advanced facial landmark
          analysis and Eye Aspect Ratio (EAR) technology.
        </p>
      </div>
    </div>
    <div class="footer-copy">
      Â© 2026 Vigilance Driver - All rights reserved.
    </div>
  </footer>

  <script src="app.js?v=2026"></script>

</body>
</html>